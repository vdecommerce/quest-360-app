<!DOCTYPE html>
<html>
  <head>
    <title>VR Cinema - Glass Design</title>
    <link rel="icon" href="data:,">
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>

    <style>
      #splash {
        position: absolute; z-index: 999; top: 0; left: 0; 
        width: 100%; height: 100%; background: rgba(0,0,0,0.9); 
        display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; font-family: sans-serif;
      }
      #start-btn {
        padding: 20px 40px; font-size: 24px; background: linear-gradient(45deg, #4facfe, #00f2fe);
        color: white; border: none; border-radius: 50px; cursor: pointer; margin-top: 20px;
        box-shadow: 0 4px 15px rgba(0,242,254, 0.4);
      }
    </style>

    <script>
      // --- DE MOVE TOOL (Nu voor de hele container) ---
      AFRAME.registerComponent('drag-handler', {
        init: function () {
          // We luisteren naar events op deze container (bubbling zorgt dat clicks op kinderen ook werken)
          this.el.addEventListener('mousedown', this.onMouseDown.bind(this));
          this.el.addEventListener('mouseup', this.onMouseUp.bind(this));
          this.isDragging = false;
        },
        onMouseDown: function (evt) {
           // Check of we een knop raken, dan NIET slepen
           if (evt.target.id && evt.target.id.endsWith('-button') || evt.target.parentNode.id && evt.target.parentNode.id.endsWith('-button')) return;

          var controller = evt.detail.cursorEl;
          if (controller) {
             controller.object3D.attach(this.el.object3D);
             this.isDragging = true;
          }
        },
        onMouseUp: function (evt) {
          if (this.isDragging) {
             var scene = document.querySelector('a-scene');
             scene.object3D.attach(this.el.object3D);
             this.isDragging = false;
          }
        }
      });

      // --- DE LOGICA ---
      document.addEventListener('DOMContentLoaded', function() {
        const splash = document.querySelector('#splash');
        const startBtn = document.querySelector('#start-btn');
        const videoElement = document.querySelector('#bios-video');
        const ambientSound = document.querySelector('#ambient-sound-entity');
        const playButton = document.querySelector('#play-button');
        const playIcon = document.querySelector('#play-icon');
        const stopButton = document.querySelector('#stop-button');
        const volDownButton = document.querySelector('#vol-down-button');
        const volUpButton = document.querySelector('#vol-up-button');
        const minimizeButton = document.querySelector('#minimize-button');
        const restoreButton = document.querySelector('#restore-button');
        const videoScreen = document.querySelector('#cinema-rig a-video');
        const controlsBar = document.querySelector('#cinema-rig a-box');

        let isPlaying = false;

        startBtn.addEventListener('click', function() {
          splash.style.display = 'none';
          ambientSound.components.sound.playSound();
          videoElement.play().then(() => { videoElement.pause(); });
        });

        playButton.addEventListener('click', function() {
          if (isPlaying) {
            videoElement.pause();
            // Verander icoon naar PLAY (â–¶)
            playIcon.setAttribute('text', 'value: \u25B6'); 
            // Kleur terug naar wit glas
            playButton.setAttribute('material', 'color: white; opacity: 0.2');
          } else {
            videoElement.play();
            // Verander icoon naar PAUSE (||)
            playIcon.setAttribute('text', 'value: ||'); 
            // Kleur naar actief blauw
            playButton.setAttribute('material', 'color: #00f2fe; opacity: 0.6');
          }
          isPlaying = !isPlaying;
        });

        // Hover effectjes voor de knop
        playButton.addEventListener('mouseenter', function() {
           if(!isPlaying) this.setAttribute('material', 'opacity: 0.5');
        });
        playButton.addEventListener('mouseleave', function() {
            if(!isPlaying) this.setAttribute('material', 'opacity: 0.2');
        });

        // Stop Button
        stopButton.addEventListener('click', function() {
          videoElement.pause();
          videoElement.currentTime = 0;
          playIcon.setAttribute('text', 'value: \u25B6');
          playButton.setAttribute('material', 'color: white; opacity: 0.2');
          isPlaying = false;
        });
        stopButton.addEventListener('mouseenter', function() {
          this.setAttribute('material', 'opacity: 0.5');
        });
        stopButton.addEventListener('mouseleave', function() {
          this.setAttribute('material', 'opacity: 0.2');
        });

        // Volume Down
        volDownButton.addEventListener('click', function() {
          videoElement.volume = Math.max(0, videoElement.volume - 0.1);
        });
        volDownButton.addEventListener('mouseenter', function() {
          this.setAttribute('material', 'opacity: 0.5');
        });
        volDownButton.addEventListener('mouseleave', function() {
          this.setAttribute('material', 'opacity: 0.2');
        });

        // Volume Up
        volUpButton.addEventListener('click', function() {
          videoElement.volume = Math.min(1, videoElement.volume + 0.1);
        });
        volUpButton.addEventListener('mouseenter', function() {
          this.setAttribute('material', 'opacity: 0.5');
        });
        volUpButton.addEventListener('mouseleave', function() {
          this.setAttribute('material', 'opacity: 0.2');
        });

        // Minimize
        minimizeButton.addEventListener('click', function() {
          videoScreen.setAttribute('visible', false);
          controlsBar.setAttribute('visible', false);
          stopButton.setAttribute('visible', false);
          playButton.setAttribute('visible', false);
          volDownButton.setAttribute('visible', false);
          volUpButton.setAttribute('visible', false);
          minimizeButton.setAttribute('visible', false);
          restoreButton.setAttribute('visible', true);
        });
        minimizeButton.addEventListener('mouseenter', function() {
          this.setAttribute('material', 'opacity: 0.5');
        });
        minimizeButton.addEventListener('mouseleave', function() {
          this.setAttribute('material', 'opacity: 0.2');
        });

        // Restore
        restoreButton.addEventListener('click', function() {
          videoScreen.setAttribute('visible', true);
          controlsBar.setAttribute('visible', true);
          stopButton.setAttribute('visible', true);
          playButton.setAttribute('visible', true);
          volDownButton.setAttribute('visible', true);
          volUpButton.setAttribute('visible', true);
          minimizeButton.setAttribute('visible', true);
          restoreButton.setAttribute('visible', false);
        });
        restoreButton.addEventListener('mouseenter', function() {
          this.setAttribute('material', 'opacity: 0.5');
        });
        restoreButton.addEventListener('mouseleave', function() {
          this.setAttribute('material', 'opacity: 0.2');
        });
      });
    </script>
  </head>
  <body>
    
    <div id="splash">
      <h1>Cinema Glass</h1>
      <p>Pak het scherm vast aan de randen. Klik op de knop om te spelen.</p>
      <button id="start-btn">Enter VR</button>
    </div>

    <a-scene>
      <a-assets>
        <img id="sky-texture" src="assets/foto.png">
        <audio id="ambient-src" src="assets/geluid.mp3"></audio>
        <video id="bios-video" src="assets/video.mp4" loop="true" preload="auto" playsinline webkit-playsinline></video>
      </a-assets>

      <a-sky src="#sky-texture" rotation="0 -90 0"></a-sky>
      <a-sound id="ambient-sound-entity" src="#ambient-src" autoplay="false" loop="true" volume="0.3" position="0 2 0"></a-sound>

      <a-entity id="cinema-rig" position="0 2.5 -5" drag-handler>
        
        <a-video src="#bios-video" width="8" height="4.5" class="clickable"></a-video>

        <a-box position="0 -2.6 0.1" 
               width="8" height="0.8" depth="0.05"
               material="color: #ffffff; opacity: 0.15; transparent: true; metalness: 0.1; roughness: 0.2"
               class="clickable"> </a-box>

        <a-cylinder id="play-button"
                    position="0 -2.6 0.15"
                    rotation="90 0 0"
                    radius="0.3" height="0.05"
                    material="color: white; opacity: 0.2; transparent: true"
                    class="clickable">

            <a-entity id="play-icon"
                      text="value: \u25B6; align: center; color: white; width: 4;"
                      position="0 -0.06 0"
                      rotation="-90 0 0">
            </a-entity>
        </a-cylinder>

        <!-- Stop Button -->
        <a-cylinder id="stop-button"
                    position="-1.2 -2.6 0.15"
                    rotation="90 0 0"
                    radius="0.3" height="0.05"
                    material="color: white; opacity: 0.2; transparent: true"
                    class="clickable">
            <a-entity text="value: \u25A0; align: center; color: white; width: 4;"
                      position="0 -0.06 0"
                      rotation="-90 0 0">
            </a-entity>
        </a-cylinder>

        <!-- Volume Down -->
        <a-cylinder id="vol-down-button"
                    position="0.8 -2.6 0.15"
                    rotation="90 0 0"
                    radius="0.3" height="0.05"
                    material="color: white; opacity: 0.2; transparent: true"
                    class="clickable">
            <a-entity text="value: -; align: center; color: white; width: 4;"
                      position="0 -0.06 0"
                      rotation="-90 0 0">
            </a-entity>
        </a-cylinder>

        <!-- Volume Up -->
        <a-cylinder id="vol-up-button"
                    position="1.6 -2.6 0.15"
                    rotation="90 0 0"
                    radius="0.3" height="0.05"
                    material="color: white; opacity: 0.2; transparent: true"
                    class="clickable">
            <a-entity text="value: +; align: center; color: white; width: 4;"
                      position="0 -0.06 0"
                      rotation="-90 0 0">
            </a-entity>
        </a-cylinder>

        <!-- Minimize Button -->
        <a-cylinder id="minimize-button"
                    position="2.4 -2.6 0.15"
                    rotation="90 0 0"
                    radius="0.3" height="0.05"
                    material="color: white; opacity: 0.2; transparent: true"
                    class="clickable">
            <a-entity text="value: _; align: center; color: white; width: 4;"
                      position="0 -0.06 0"
                      rotation="-90 0 0">
            </a-entity>
        </a-cylinder>

        <!-- Restore Button -->
        <a-cylinder id="restore-button"
                    position="0 -2.6 0.15"
                    rotation="90 0 0"
                    radius="0.3" height="0.05"
                    material="color: white; opacity: 0.2; transparent: true"
                    class="clickable"
                    visible="false">
            <a-entity text="value: \u25A1; align: center; color: white; width: 4;"
                      position="0 -0.06 0"
                      rotation="-90 0 0">
            </a-entity>
        </a-cylinder>

      </a-entity> <a-entity oculus-touch-controls="hand: left" laser-controls="hand: left" raycaster="objects: .clickable; far: 20"></a-entity>
      <a-entity oculus-touch-controls="hand: right" laser-controls="hand: right" raycaster="objects: .clickable; far: 20"></a-entity>
      
      <a-entity camera look-controls position="0 1.6 0">
         <a-cursor color="#00f2fe" raycaster="objects: .clickable"></a-cursor>
      </a-entity>

    </a-scene>
  </body>
</html>